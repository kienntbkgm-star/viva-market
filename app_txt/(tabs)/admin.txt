# TÃ“M Táº®T LOGIC TRANG ADMIN.TSX

## ğŸ¯ Má»¤C ÄÃCH
Dashboard tá»•ng quan dÃ nh cho admin:
- Hiá»ƒn thá»‹ cÃ¡c chá»‰ sá»‘ thá»‘ng kÃª Ä‘Æ¡n hÃ ng food (cancelled, pending, processing, delayed)
- Hiá»ƒn thá»‹ thá»‘ng kÃª shipper sáºµn sÃ ng
- Menu Ä‘iá»u hÆ°á»›ng Ä‘áº¿n cÃ¡c trang quáº£n lÃ½:
  - MÃ³n Äƒn (products)
  - ÄÆ¡n hÃ ng (orders)
  - NgÆ°á»i dÃ¹ng (users)
  - Hoáº¡t Ä‘á»™ng (activity-tracking)
  - TÃ i chÃ­nh (finance)
  - CÃ i Ä‘áº·t (system-config)

## ğŸ“Š STATE & DATA

**Store:**
- `foods`: danh sÃ¡ch mÃ³n Äƒn (Ä‘á»ƒ Ä‘áº¿m activeFoods)
- `foodOrders`: danh sÃ¡ch Ä‘Æ¡n hÃ ng food (Ä‘á»ƒ tÃ­nh stats)
- `users`: danh sÃ¡ch ngÆ°á»i dÃ¹ng (Ä‘á»ƒ Ä‘áº¿m user vÃ  shipper)
- `promos`: danh sÃ¡ch khuyáº¿n mÃ£i (khÃ´ng dÃ¹ng trong page nÃ y)

**Computed Values:**
- `stats`: Object chá»©a 4 chá»‰ sá»‘ Ä‘Æ¡n hÃ ng
  - `cancelled`: Sá»‘ Ä‘Æ¡n bá»‹ há»§y
  - `pending`: Sá»‘ Ä‘Æ¡n chá» xÃ¡c nháº­n (pending + pendding)
  - `processing`: Sá»‘ Ä‘Æ¡n Ä‘ang xá»­ lÃ½
  - `delayed`: Sá»‘ Ä‘Æ¡n cháº­m (>30 phÃºt vÃ  chÆ°a hoÃ n thÃ nh/há»§y)
- `activeFoods`: Sá»‘ mÃ³n cÃ³ `status === 'enable'`
- `totalUsers`: Tá»•ng sá»‘ ngÆ°á»i dÃ¹ng
- `readyShippers`: Sá»‘ shipper cÃ³ `isReady === true`
- `totalShippers`: Tá»•ng sá»‘ shipper

## ğŸ”„ LUá»’NG THá»°C THI

1. **Load dá»¯ liá»‡u:** Láº¥y foods, foodOrders, users tá»« store
2. **TÃ­nh toÃ¡n stats (useMemo):**
   - Filter foodOrders theo status
   - TÃ­nh delayed dá»±a vÃ o `createdAt` so vá»›i hiá»‡n táº¡i
3. **Render dashboard:**
   - 4 card stats (2 hÃ ng x 2 cá»™t)
   - 1 card shipper sáºµn sÃ ng (full width)
   - 6 card menu quáº£n lÃ½
4. **Nháº¥n menu card:** Navigate Ä‘áº¿n path tÆ°Æ¡ng á»©ng

## ğŸ”§ CÃC FUNCTION QUAN TRá»ŒNG

### Logic Ä‘áº¿m Ä‘Æ¡n Delayed
```js
delayed: orders.filter(o => {
  if (o.status === 'completed' || o.status === 'cancelled') return false;
  const timeStr = o.createdAt || o.timeCreate;
  if (!timeStr) return false;
  
  const orderTime = new Date(timeStr);
  const diffInMinutes = (now.getTime() - orderTime.getTime()) / (1000 * 60);
  return diffInMinutes > 30;
}).length
```

### Menu Config
```js
const adminMenu = [
  { id: 'products', title: 'Quáº£n lÃ½ MÃ³n Äƒn', subtitle: `${activeFoods} mÃ³n Ä‘ang bÃ¡n`, icon: 'restaurant-menu', color: '#E67E22', path: '/admin/products' },
  { id: 'orders', title: 'Quáº£n lÃ½ ÄÆ¡n hÃ ng', subtitle: `${stats.pending} Ä‘Æ¡n chá» duyá»‡t`, icon: 'receipt-long', color: '#3498DB', path: '/admin/orders' },
  { id: 'users', title: 'Quáº£n lÃ½ NgÆ°á»i dÃ¹ng', subtitle: `${totalUsers} tÃ i khoáº£n`, icon: 'people', color: '#9B59B6', path: '/admin/users' },
  { id: 'activity', title: 'Thá»‘ng kÃª Hoáº¡t Ä‘á»™ng', subtitle: `${readyShippers} shippers sáºµn sÃ ng`, icon: 'analytics', color: '#16A085', path: '/admin/activity-tracking' },
  { id: 'finance', title: 'Quáº£n lÃ½ TÃ i chÃ­nh', subtitle: 'Äá»‘i soÃ¡t cÃ´ng ná»£ Shipper', icon: 'attach-money', color: '#27AE60', path: '/admin/finance' },
  { id: 'system', title: 'CÃ i Ä‘áº·t', subtitle: 'Cáº¥u hÃ¬nh há»‡ thá»‘ng', icon: 'settings', color: '#7F8C8D', path: '/admin/system-config' }
];
```

## ğŸ¨ UI Cáº¤U TRÃšC

```
SafeAreaView
  â”œâ”€ Header
  â”‚   â”œâ”€ Title: "Quáº£n trá»‹ viÃªn"
  â”‚   â”œâ”€ Subtitle: "Há»‡ thá»‘ng váº­n hÃ nh chung cÆ°"
  â”‚   â””â”€ Profile Button (icon person-circle)
  â”‚
  â””â”€ ScrollView (padding: 20)
      â”œâ”€ Stats Row 1
      â”‚   â”œâ”€ Card: Bá»‹ há»§y (border left #E74C3C)
      â”‚   â””â”€ Card: Pending (border left #F1C40F)
      â”‚
      â”œâ”€ Stats Row 2
      â”‚   â”œâ”€ Card: Processing (border left #3498DB)
      â”‚   â””â”€ Card: ÄÆ¡n cháº­m >30p (border left #E67E22)
      â”‚
      â”œâ”€ Stats Row 3
      â”‚   â””â”€ Card: Shipper sáºµn sÃ ng (border left #27AE60, full width)
      â”‚
      â””â”€ Menu Cards (6 cards)
          â””â”€ Each Card:
              â”œâ”€ Icon Circle (mÃ u theo config)
              â”œâ”€ Title + Subtitle
              â””â”€ Chevron forward
```

## âš¡ ÄIá»‚M Äáº¶C BIá»†T

1. **Food Orders Only:** Stats chá»‰ tÃ­nh Ä‘Æ¡n food, khÃ´ng tÃ­nh service/good orders
2. **Pending vs Pendding:** Xá»­ lÃ½ cáº£ 2 typo (pending + pendding)
3. **Delayed Logic:** ÄÆ¡n >30 phÃºt vÃ  chÆ°a completed/cancelled
4. **Border Left Color Coding:** Má»—i stat card cÃ³ mÃ u border trÃ¡i khÃ¡c nhau
5. **Icon Circle Background:** `backgroundColor: color + '15'` (15% opacity)
6. **Profile Button:** Hiá»ƒn thá»‹ nhÆ°ng chÆ°a cÃ³ chá»©c nÄƒng (placeholder)
7. **Dynamic Subtitle:** Subtitle menu card thay Ä‘á»•i theo sá»‘ liá»‡u thá»±c táº¿
8. **Card Elevation:** Táº¥t cáº£ card Ä‘á»u cÃ³ `elevation: 2` (Android) vÃ  `shadowOpacity: 0.05` (iOS)
9. **No Loading State:** Giáº£ Ä‘á»‹nh dá»¯ liá»‡u Ä‘Ã£ load xong tá»« index.tsx
10. **Color Palette:** Sá»­ dá»¥ng mÃ u chuáº©n Material Design

## ğŸš€ USER JOURNEY

**Admin:**
1. VÃ o Admin tab (bottom navigation hoáº·c tá»« profile)
2. Xem tá»•ng quan dashboard:
   - Sá»‘ Ä‘Æ¡n bá»‹ há»§y, pending, processing, cháº­m
   - Sá»‘ shipper sáºµn sÃ ng
3. Nháº¥n vÃ o menu card Ä‘á»ƒ vÃ o trang quáº£n lÃ½ cá»¥ thá»ƒ:
   - Products: Quáº£n lÃ½ mÃ³n Äƒn
   - Orders: Quáº£n lÃ½ Ä‘Æ¡n hÃ ng
   - Users: Quáº£n lÃ½ ngÆ°á»i dÃ¹ng
   - Activity: Thá»‘ng kÃª hoáº¡t Ä‘á»™ng
   - Finance: Äá»‘i soÃ¡t tÃ i chÃ­nh shipper
   - System: Cáº¥u hÃ¬nh há»‡ thá»‘ng

## ğŸ”— NAVIGATION

**Navigates TO:**
- `/admin/products`
- `/admin/orders`
- `/admin/users`
- `/admin/activity-tracking`
- `/admin/finance`
- `/admin/system-config`

**Navigates FROM:**
- `/profile` (nÃºt "Quáº£n trá»‹ há»‡ thá»‘ng" - admin only)
- Bottom tab navigation (náº¿u cÃ³ admin tab - chÆ°a rÃµ logic hiá»‡n)

## ğŸ’¡ LÆ¯U Ã Ká»¸ THUáº¬T

1. **Stats Object Structure:**
   ```js
   {
     cancelled: number,
     pending: number,
     processing: number,
     delayed: number
   }
   ```
2. **useMemo Dependency:** `[foodOrders]` Ä‘á»ƒ tÃ­nh láº¡i stats khi Ä‘Æ¡n hÃ ng thay Ä‘á»•i
3. **Time Calculation:**
   ```js
   const diffInMinutes = (now.getTime() - orderTime.getTime()) / (1000 * 60);
   ```
4. **Filter activeFoods:**
   ```js
   foods.filter(f => f.status === 'enable').length
   ```
5. **Filter readyShippers:**
   ```js
   users.filter(u => u.role === 'shipper' && u.isReady === true).length
   ```
6. **Status lowercase:** LuÃ´n chuyá»ƒn vá» lowercase trÆ°á»›c khi so sÃ¡nh
7. **MaterialIcons:** DÃ¹ng cho icon menu, Ionicons cho icon khÃ¡c
8. **Card Border Radius:** 15 (stats), 20 (menu)
9. **Header Border Radius:** Bottom left 30, bottom right 30
10. **Icon Circle Size:** 55x55, borderRadius 18
11. **Profile Button:** ChÆ°a navigate Ä‘i Ä‘Ã¢u, cÃ³ thá»ƒ lÃ  placeholder cho tÆ°Æ¡ng lai
12. **Order Time Field:** Æ¯u tiÃªn `createdAt`, fallback `timeCreate`
13. **No Error Handling:** Giáº£ Ä‘á»‹nh dá»¯ liá»‡u luÃ´n cÃ³ sáºµn
14. **Shipper Display:** `{readyShippers}/{totalShippers}` format
15. **Menu Card Gap:** marginBottom 15 giá»¯a cÃ¡c card

## ğŸ” SO SÃNH Vá»šI SHIPPER TAB

**Giá»‘ng:**
- Äá»u hiá»ƒn thá»‹ thá»‘ng kÃª tá»•ng quan
- Äá»u cÃ³ navigation Ä‘áº¿n cÃ¡c trang con

**KhÃ¡c:**
- Admin: Stats vá» táº¥t cáº£ Ä‘Æ¡n hÃ ng food
- Admin: Menu Ä‘iá»u hÆ°á»›ng Ä‘áº¿n 6 trang quáº£n lÃ½
- Admin: KhÃ´ng cÃ³ tabs
- Shipper: Stats vá» Ä‘Æ¡n cá»§a shipper cá»¥ thá»ƒ
- Shipper: Tabs (available, my_orders, completed)
- Shipper: Focus vÃ o Ä‘Æ¡n hÃ ng cÃ¡ nhÃ¢n
